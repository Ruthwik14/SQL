<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/SAI RAM/Desktop/SQL/the company's dvd rental business/sqlite-sakila.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser query" current="2"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="125"/><column_width id="3" width="8574"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,13:maincustomer_list"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="actor" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="81"/><column index="2" value="117"/><column index="3" value="127"/><column index="4" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="address" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="2" mode="0"/></sort><column_widths><column index="1" value="104"/><column index="2" value="300"/><column index="3" value="88"/><column index="4" value="70"/><column index="5" value="68"/><column index="6" value="115"/><column index="7" value="64"/><column index="8" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="category" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="112"/><column index="2" value="106"/><column index="3" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="city" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="68"/><column index="2" value="212"/><column index="3" value="103"/><column index="4" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="country" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="103"/><column index="2" value="297"/><column index="3" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="customer" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="3" mode="0"/></sort><column_widths><column index="1" value="117"/><column index="2" value="81"/><column index="3" value="117"/><column index="4" value="139"/><column index="5" value="300"/><column index="6" value="104"/><column index="7" value="61"/><column index="8" value="194"/><column index="9" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="customer_list" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="52"/><column index="2" value="220"/><column index="3" value="300"/><column index="4" value="87"/><column index="5" value="64"/><column index="6" value="212"/><column index="7" value="297"/><column index="8" value="58"/><column index="9" value="52"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="film" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="8" mode="1"/></sort><column_widths><column index="1" value="70"/><column index="2" value="281"/><column index="3" value="300"/><column index="4" value="119"/><column index="5" value="116"/><column index="6" value="192"/><column index="7" value="144"/><column index="8" value="105"/><column index="9" value="65"/><column index="10" value="163"/><column index="11" value="61"/><column index="12" value="300"/><column index="13" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="film_actor" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="81"/><column index="2" value="70"/><column index="3" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="film_category" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="70"/><column index="2" value="112"/><column index="3" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="film_list" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="52"/><column index="2" value="232"/><column index="3" value="300"/><column index="4" value="85"/><column index="5" value="52"/><column index="6" value="65"/><column index="7" value="61"/><column index="8" value="208"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="film_text" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="70"/><column index="2" value="52"/><column index="3" value="106"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="inventory" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="119"/><column index="2" value="70"/><column index="3" value="81"/><column index="4" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="language" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="116"/><column index="2" value="76"/><column index="3" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="payment" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="112"/><column index="2" value="117"/><column index="3" value="77"/><column index="4" value="87"/><column index="5" value="76"/><column index="6" value="194"/><column index="7" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="rental" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="87"/><column index="2" value="194"/><column index="3" value="119"/><column index="4" value="117"/><column index="5" value="194"/><column index="6" value="77"/><column index="7" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="sales_by_film_category" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="85"/><column index="2" value="104"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="sales_by_store" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="81"/><column index="2" value="157"/><column index="3" value="105"/><column index="4" value="104"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="staff" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="77"/><column index="2" value="103"/><column index="3" value="99"/><column index="4" value="104"/><column index="5" value="70"/><column index="6" value="231"/><column index="7" value="81"/><column index="8" value="61"/><column index="9" value="94"/><column index="10" value="300"/><column index="11" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="staff_list" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="52"/><column index="2" value="105"/><column index="3" value="152"/><column index="4" value="87"/><column index="5" value="64"/><column index="6" value="86"/><column index="7" value="76"/><column index="8" value="52"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="store" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="81"/><column index="2" value="163"/><column index="3" value="104"/><column index="4" value="162"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">--The business wants to run email campaigns for customers in store id 2, for that it needs the email ids, first name as well as last name of the customers. Write a query to fetch this data.
SELECT first_name,last_name,email from customer where store_id = 2;

--While doing the audit of the business, one of the financial analyst found out that some dvd's are being rented out for $0.99. The finance department needs the count of such movies whose rental rate is $0.99. Can you help them?
SELECT count(film_id) from film where rental_rate = 0.99;

--The accounts department, is thinking of comping up with a different way of accounting for the business costs. To be able to do that they need to find out the number of movies rented at different rental price points. Write an sql query so that this crucial input can be provided to the accounts department.
SELECT rental_rate,count(film_id) AS TOTAL_NO_FILMS from film GROUP BY rental_rate ;

--The marketing team wants to understand how number of movies is spread across movie ratings. Can you help them?
SELECT rating,count(film_id) AS TOTAL_NO_FILMS from film GROUP BY rating ;

--The marketing team now also wants to know how ratings are distributed across stores. The team needs to know the distribution of ratings for each store in the dataset. Write a sql query to help solve this problem.
SELECT b.store_id, a.rating, COUNT(a.film_id) AS TOTAL_NO_FILMS
FROM film a
JOIN inventory b ON a.film_id = b.film_id
GROUP BY b.store_id,a.rating;

--The digital marketing team is studying what other movie rental businesses are doing. One of the analysis that they want to do is study what are the kind of movies that are being rented out by competitors as well as the current company. Your job is to provide the team with details on film name, category each film belongs to and the language in which the film is.
select f.title,c.name,l.name 
from film f 
join  film_category fc ON fC.film_id = f.film_id
join category c ON fc.category_id = c.category_id 
join language l ON l.language_id = f.language_id;

--One of the questions that the business is interested in is about the popularity of the movies in the current inventory also the stores and customers who bring in more revenue. Help the business in finding out
--the number of times each movie is rented out
select f.title,count(r.rental_id) as no_of_rented from film f 
join inventory i on f.film_id = i.film_id 
join rental r on  r.inventory_id = i.inventory_id group by f.title order by no_of_rented DESC;  

--Revenue pre movie
SELECT f.film_id, f.title, sum(p.amount) AS total_revenue
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN payment p ON p.rental_id = r.rental_id
GROUP BY f.film_id,f.title
ORDER BY total_revenue DESC;

--Most revenue earned by a store
SELECT s.store_id, SUM(p.amount) AS &quot;Total Spending&quot;
FROM store s
JOIN inventory i ON i.store_id = s.store_id
JOIN rental r ON r.inventory_id = i.inventory_id
JOIN payment p ON p.rental_id = r.rental_id
GROUP BY 1
ORDER BY 2 DESC;

Which customer has spent the most

select c.id,c.name,sum(p.amount)as Total_sales1 FROM customer_list c join payment p on p.customer_id = c.id group by c.id,c.name order by Total_sales1 desc LIMIT 1;

--One important aspect of business is loyalty and reward programs for customers as well as internal stakeholder. The business is currently looking at launching some strategic initiatives for which they need to know the following information

--Last Rental Date of every customer
select c.id,c.name,max(r.rental_date) as last_rental_date FROM customer_list c join rental r on r.customer_id = c.id group by c.id,c.name order by id;

--Total Revenue Per Month
select strftime(&quot;%m&quot;,rental_date) as month,sum(amount) as &quot;total revenue&quot;  from payment p join rental r on p.customer_id = r.customer_id group by month

--Number of distinct Renters per month
SELECT strftime(&quot;%m&quot;,rental_date) AS &quot;Month&quot;, 
	COUNT(DISTINCT(rental_id)) AS &quot;Total Rentals&quot;,
	COUNT(DISTINCT(customer_id)) AS &quot;Number Of Unique Renter&quot;, 
FROM rental
GROUP BY 1;

--Number of Distinct Film Rented Each Month
SELECT i.film_id, f.title, strftime(&quot;%m&quot;,r.rental_date) AS &quot;Month&quot;, COUNT(i.film_id) AS &quot;Total Number Of Rental Times&quot;
FROM rental r
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON f.film_id = i.film_id
GROUP BY i.film_id, strftime(&quot;%m&quot;,r.rental_date)
ORDER BY 1, 2, 3;

--Number of Rentals in Comedy , Sports and Family
SELECT c.name, COUNT(c.name) AS &quot;Number of Rentals&quot;
FROM film f
JOIN film_category fc ON fc.film_id = f.film_id
JOIN category c ON c.category_id = fc.category_id
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON r.inventory_id = i.inventory_id
WHERE c.name IN (&quot;Comedy&quot;, &quot;Sports&quot;, &quot;Family&quot;)
GROUP BY 1;

--Users who have been rented at least 3 times
SELECT  c.id,c.name,COUNT(c.id) AS &quot;Total Rentals&quot;
FROM customer_list c
JOIN rental r ON c.id = r.customer_id
GROUP BY c.id
HAVING &quot;Total Rentals&quot; &gt;= 3
ORDER BY 1;


--How much revenue has one single store made over PG13 and R rated films
SELECT s.store_id, f.rating, SUM(p.amount) AS &quot;Total Revenue&quot;
FROM store s 
JOIN inventory i ON i.store_id = s.store_id
JOIN rental r ON r.inventory_id = i.inventory_id
JOIN payment p ON p.rental_id = r.rental_id
JOIN film f ON f.film_id = i.film_id
WHERE f.rating IN (&quot;PG-13&quot;, &quot;R&quot;)
GROUP BY 1,2;


</sql><current_tab id="0"/></tab_sql></sqlb_project>
